<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Rocket.Chat SDK | evanslack.dev</title>
<meta name="keywords" content="Golang, SDK">
<meta name="description" content="Improving Rocket.Chat Golang SDK as part of Google Summer of Code">
<meta name="author" content="">
<link rel="canonical" href="https://evanslack.dev/rocketchat">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css" integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://evanslack.dev/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://evanslack.dev/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://evanslack.dev/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://evanslack.dev/apple-touch-icon.png">
<link rel="mask-icon" href="https://evanslack.dev/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://evanslack.dev/" accesskey="h" title="evanslack.dev (Alt + H)">evanslack.dev</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://evanslack.dev/" title="home">
                    <span>home</span>
                </a>
            </li>
            <li>
                <a href="https://evanslack.dev/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://evanslack.dev/projects/" title="projects">
                    <span>projects</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://evanslack.dev/">Home</a>&nbsp;»&nbsp;<a href="https://evanslack.dev/projects/">Projects</a></div>
    <h1 class="post-title">
      Rocket.Chat SDK
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><p><a href="https://github.com/RocketChat/Rocket.Chat.Go.SDK">github</a>
   |   
<a href="https://github.com/orgs/RocketChat/projects/48">project</a></p>
<h2 id="about">About<a hidden class="anchor" aria-hidden="true" href="#about">#</a></h2>
<p>Over the summer of 2022 I was given the opportunity to participate in <a href="https://summerofcode.withgoogle.com/">Google Summer of Code</a>, a project that Google organizes to give developers the chance to contribute to open source at a deeper level. I worked alongside developers at <a href="https://github.com/RocketChat">rocket.chat</a>, a company that creates a communications platform similar to Slack or Microsoft Teams. During a 12 week period, I was responsible for improving their SDK, which allows users to make calls to the rocket.chat API natively in Go.</p>
<h2 id="contributions">Contributions<a hidden class="anchor" aria-hidden="true" href="#contributions">#</a></h2>
<p>See all related pull requests, issues, and discussions <a href="https://github.com/orgs/RocketChat/projects/48/views/1">here</a></p>
<h4 id="expanding-endpoint-coverage">Expanding Endpoint Coverage<a hidden class="anchor" aria-hidden="true" href="#expanding-endpoint-coverage">#</a></h4>
<p>The majority of my contributions were related to expanding the coverage of the SDK. When I started, only 23 endpoints were covered by the SDK. Over the period I was working on the project, I was directly responsible for adding coverage for an addition 16 endpoints (though at the time of writing not all code has been approved and merged).</p>
<p>Most of my work involved using a wrapper around Go&rsquo;s <code>net/http</code> client to make HTTP calls to the rocket.chat backend. All work was completed following test driven development, so for every feature that was added, I ensured there were corresponding tests to confirm functionality. Testing was carried out using Go&rsquo;s <code>testing</code> library as well as the <a href="https://github.com/stretchr/testify"><code>testify</code></a> library.</p>
<p>One thing I found was critical create Go structs that correctly mirrored the backend&rsquo;s Typescript types. It was important to add annotations to the structs so that fields were properly marshalled to and from JSON and that fields were tagged with the the <code>omitempty</code> tag when necessary.</p>
<p>In addition, I had to take care to consider how different errors should be handled throughout the SDK. There were a mix of potential errors that could arise; general HTTP errors, specific rocket.chat endpoint errors, and internal errors from potentially incorrect marshalling. It became important to consider how to wrap errors to provide correct context to end users of the SDK.</p>
<h4 id="refactoring">Refactoring<a hidden class="anchor" aria-hidden="true" href="#refactoring">#</a></h4>
<p>Beyond expanding coverage, I spent time collaborating with my mentors and other contributors to propose changes to improve existing parts of the codebase. The most significant improvement that I implemented was to standardize the return types of various method calls across the SDK. Previously, the pattern was to return a <code>Response</code> stuct with embedded fields including the desired resource and a custom error type. The following example shows a method stub and corresponding response struct from the previous iteration.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">MessagesResponse</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Messages</span> []<span style="color:#a6e22e">Messages</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Status</span> <span style="color:#a6e22e">ErrorStatus</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetMessages</span>(<span style="color:#a6e22e">channel</span> <span style="color:#a6e22e">str</span>) <span style="color:#a6e22e">MessagesResponse</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>I discussed the reasoning behind this implementation with my mentors and proposed changing the function signature to be more idiomatic Go, where errors are returned alongside resources. I then implemented the proposed changes across all methods, leading to the following function signature:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetMessages</span>(<span style="color:#a6e22e">channel</span> <span style="color:#a6e22e">str</span>) ([]<span style="color:#a6e22e">Messages</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The change is small but is important to be consistent with traditional Go patterns. One of the (subjectively) greatest parts of the language is that it is verbose when it comes to error handling and most developers are accustomed to the pattern of checking a returned error for <code>nil</code> before proceeding.</p>
<h4 id="containerizing-the-development-environment">Containerizing the Development Environment<a hidden class="anchor" aria-hidden="true" href="#containerizing-the-development-environment">#</a></h4>
<p>When I started working on the project, there were no instructions to help with setting up for local development. My first contribution was to expand the README to include details about how to build and test the source code locally. This included directions for configuring a docker-compose file responsible for spinning up the rocket.chat server and MongoDB instance for persistance.</p>
<p>After working on the project for a while, I found myself making modifications to the rocket.chat server in the docker-compose stack, namely adding environmental variables to disable rate limiting on the backend which made testing much faster. I then worked with my mentor to submit a pull request incorporating this docker-compose file into the repository along with improved instructions in the README to properly utilize this development environment.</p>
<p>This contribution is important as it standardizes the environment in which all contributors run local tests. All new pull requests can be consistently tested, thus improving developer experience.</p>
<h2 id="takeaways">Takeaways<a hidden class="anchor" aria-hidden="true" href="#takeaways">#</a></h2>
<p>While I had made previous contributions to a variety of open source projects, this was my first time investing this much time into one community. I improved my general coding skills and also learned some important lessons related to contributing to and maintaining larger open source projects.</p>
<p><strong>Introducing breaking changes should not be taken lightly</strong> - backwards compatibility is an important concept. Even though the SDK is not considered to be at a stable release and warns users that changes are to be expected, heavy consideration is needed before introducing breaking changes.</p>
<p><strong>Small and isolated pull requests are easier to manage</strong> - I had a lot of success with creating feature branches off of main to implement smaller improvements and contributions. This lead to focused pull requests that are easier to review and merge.</p>
<p><strong>Pace of code review in open source</strong> - sometimes maintainers have limited time to review pull requests. It is therefore important to communicate to ensure contributions are addressing the right problems.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://evanslack.dev/tags/golang/">Golang</a></li>
      <li><a href="https://evanslack.dev/tags/sdk/">SDK</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://evanslack.dev/projects/pyminion/">
    <span class="title">« Prev</span>
    <br>
    <span>Pyminion</span>
  </a>
  <a class="next" href="https://evanslack.dev/projects/samila/">
    <span class="title">Next »</span>
    <br>
    <span>Samila</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://evanslack.dev/">evanslack.dev</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
